<div id="patentKhgl" class="gui-div">
    <table class="toolbar-table" data-options="id: 'patentKhglTable',herf:'kzzx/gridset/query'">
    </table>

    <!-- 表格工具栏开始 -->
    <div id="patentKhglTable-toolbar" class="gui-toolbar"
         data-options="grid:{
	           type:'datagrid',
	           id:'patentKhglTable'
	       }">
        <a class="toolbar-reload toolbar" href="javascript:void(0)"></a>
        <!--<a class="toolbar-print toolbar" href="javascript:void(0)"></a>-->
        <a class="toolbar-import toolbar" href="javascript:void(0)"></a>
        <a class="toolbar-export toolbar" href="javascript:void(0)"></a>
        <a class="toolbar-review toolbar" href="javascript:void(0)"></a>
        <a class="toolbar-add toolbar" href="javascript:void(0)"></a>
        <!--<a class="toolbar-copy toolbar" href="javascript:void(0)"></a>-->
        <a class="toolbar-edit toolbar" href="javascript:void(0)"></a>
        <!--<a class="toolbar-delete toolbar" href="javascript:void(0)"></a>-->
        <div class="bdsug" style="height: auto; ">
            <form action="" class="query-criteria">
                <ul>
                    <li class="bdsug-store bdsug-overflow">
                        <span style="margin: 10px">
                            <label >客户：</label><input type="text" name="khmc"   class="gui-textbox" style="width: 100px;height: 24px">
                        </span>

                        <span class="serach">
                             <button type="button" class="btn btn-primary ng-binding datagrid-search query">搜索</button>
                        </span>
                    </li>
                </ul>
            </form>
        </div>
    </div>
</div>
<!-- 表格工具栏结束 -->
<script>
    /*js初始化*/
    $(function () {
        var $div = $('#patentKhgl');
        var options = {
            url: 'patent/khgl',
            queryParams: {},
            columns: [[
                {title: "客户名称", field: "khmc", fieldType: "ftString", width: 120},
                {title: "单位名称", field: "dwmc", fieldType: "ftString", width: 160},
                {title: "联系电话", field: "lxdh", fieldType: "ftString", width: 120},
                {title: "邮箱", field: "yx", fieldType: "ftString", width: 120},
                {title: "地址", field: "dz", fieldType: "ftString", width: 140},
                {title: "主营范围", field: "zyfw", fieldType: "ftString", width: 140},
                {title: "备注", field: "bz", fieldType: "ftString", width: 160},
                {title: "外勤人员", field: "khglwlryname", fieldType: "ftString", width: 120},
                {title: "内勤人员", field: "khglnlryname", fieldType: "ftString", width: 120}
            ]],
            dialog: {
                id: 'patentKhglEdit',
                width: 900,
                height: 506,
                href: 'patent/khgl/edit'
            }
        };
        $div.Container(options);

        $("#patentKhgl .toolbar-import").iMenubutton({
            event:'openDialog',
            iconCls: 'fa fa-upload',
            text:'导入',
            dialog:{
                title:'导入',
                id:'patentKhglAdd',
                width:840,
                height: 510,
                href:'patent/khgl/importpage',
                tag:'add',
                buttonsGroup:[
                    {	text:'保存',
                        iconCls:'fa fa-plus',
                        btnCls:'gui-btn-normal',
                        handler:function(){
                            var $dialog=$('#patentKhglAdd');$dialog.find('.cgjhmx').datagrid("acceptChanges");
                            var rows= $dialog.find('.cgjhmx').datagrid("getRows");
                            var queryParams=DataBind.collectData($dialog);
                            $.each(rows,function (i,row) {
                                row.month=queryParams["month"]||'';
                                row.year=queryParams["year"]||'';

                            });
                            HTTP.post("sjzx/cgjh/saveData",{datas:rows},function (result) {
                                if(result["success"]){
                                    $.messager.show({
                                        title: "温馨提示",
                                        msg: "操作成功"
                                    });
                                    $('#patentKhglAdd').iDialog("destroy");
                                    $div.find(".toolbar-reload").click();
                                }
                            })
                        }
                    }]
            }
        });

    });


</script>
