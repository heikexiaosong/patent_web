<div id="contract" class="gui-div">
    <table class="toolbar-table" data-options="id: 'contractTable'">
    </table>

    <div id="contractTable-toolbar" class="gui-toolbar" data-options="grid:{type:'datagrid',id:'contractTable'}">
        <a class="toolbar-reload toolbar" href="javascript:void(0)"></a>
        <a type="submit" class="btn btn-primary serach toolbar-search"></a>
        <div class="bdsug" style="height: auto;">
            <form action="" class="query-criteria">
                <ul>
                    <li class="bdsug-store bdsug-overflow">
                        <span style="margin: 10px">
                            <label>日期：</label>
                            <input type="text" name="start"/>
                            -
                            <input type="text" name="end" />
                        </span>
                    </li>
                </ul>
            </form>
        </div>
    </div>

</div>
<script>
    $(function () {
        var $div = $('#contract');

        $div.find('input[name="start"]').iDatebox({value: DateUtils.beginOfMonth().Format("yyyy-MM-dd")});

        $div.find('input[name="end"]').iDatebox({value: DateUtils.endOfMonth().Format("yyyy-MM-dd")});

        var options = {
            url: 'report/contract',
            queryParams:{
                start: $div.find('form input[name="start"]').val(),
                end: $div.find('form input[name="end"]').val()
            },
            columns: [[

                {title: "合同编号", index: 1, field: "CONTRACT_NO", width: 180, align: 'center'},
                {title: "供应商", index: 2, field: "SUPPLY_CODE", width: 160, align: 'center'},
                {title: "合同类别", index: 3, field: "CONT_TYPE", width: 160, align: 'center'},
                {title: "代储", index: 4, field: "DAI_FLAG", width: 160, align: 'center',
                    formatter: function (value, index, row) {
                        var map = {N: "否", Y: "是"};
                        var text = map[value];
                        return text || value;
                    }
                },
                {title: "物料号", index:5, field: "ITEM_NO", width: 160, align: 'center'},
                {title: "名称", index: 6, field: "ITEM_NOTE", width: 160, align: 'center'},
                {title: "规格", index: 7, field: "GRADE", width: 160,  align: 'center'},
                {title: "执行标准", index:8, field: "GRAPH_NO", width: 160,  align: 'center'},
                {title: "合同数量", index: 9, field: "QTY_CONT", width: 160,  align: 'center'},
                {title: "单位", index: 10, field: "PRICE_UNIT", width: 160,  align: 'center'},
                {title: "合同单价", index: 11, field: "UNIT_PRICE", width: 160,  align: 'center'},
                {title: "税率", index: 12, field: "TAX_RATE", width: 160,  align: 'center'},
                {title: "交货日期", index: 13, field: "DATE_DELIVER", width: 160,  align: 'center',
                    formatter: function (value, row, index) {
                        if (value == undefined || value == '') {
                            return "";
                        }
                        var date = new Date(parseInt(value));
                        if (isNaN(date)) {
                            return ""
                        }
                        return date.Format("yyyy-MM-dd");
                    }
                },
                {title: "合同备注", index: 14, field: "HEAD_NOTES", width: 160,  align: 'center'},
                {title: "合同金额", index: 15, field: "PRICE_SUM", width: 160,  align: 'center'},
                {title: "确认", index: 16, field: "AUDIT_ID", width: 160,  align: 'center',
                    formatter: function (value, index, row) {
                        var map = {N: "否", Y: "是"};
                        var text = map[value];
                        return text || value;
                    }
                },
                {title: "采购员", index: 17, field: "BUYER", width: 160, align: 'center'},
                {title: "执行", index: 18, field: "START_FLAG", width: 160,  align: 'center',
                    formatter: function (value, index, row) {
                        var map = {N: "否", Y: "是"};
                        var text = map[value];
                        return text || value;
                    }

                },
                {title: "物料备注", index: 19, field: "DETAIL_NOTES", width: 160,align: 'center'},
                {title: "实收数量", index: 20, field: "QTY_FACT", width: 160, align: 'center'},
                {title: "入库数量", index: 21, field: "QTY_IN", width: 160, align: 'center'},
                {title: "报废数量", index: 22, field: "QTY_SCRAP", width: 160, align: 'center'},
                {title: "采购订单号", index: 23, field: "PUR_NO", width: 160, align: 'center'},
                {title: "到货日期", index: 24, field: "DATE_GET", width: 160, align: 'center',
                    formatter: function (value, row, index) {
                        if (value == undefined || value == '') {
                            return "";
                        }
                        var date = new Date(parseInt(value));
                        if (isNaN(date)) {
                            return ""
                        }
                        return date.Format("yyyy-MM-dd");
                    }
                },
                {title: "损耗率", index: 25, field: "WASTE_RATE", width: 160, align: 'center'},
                {title: "投放日期", index: 26, field: "DATE_PUT", width: 160, align: 'center',
                    formatter: function (value, row, index) {
                        if (value == undefined || value == '') {
                            return "";
                        }
                        var date = new Date(parseInt(value));
                        if (isNaN(date)) {
                            return ""
                        }
                        return date.Format("yyyy-MM-dd");
                    }
                },
                {title: "供应商送货量", index: 27, field: "QTY_SEND", width: 160, align: 'center'},
                {title: "最后入库日期", index: 28, field: "DATE_IN_STOCK", width: 160, align: 'center',
                    formatter: function (value, row, index) {
                        if (value == undefined || value == '') {
                            return "";
                        }
                        var date = new Date(parseInt(value));
                        if (isNaN(date)) {
                            return ""
                        }
                        return date.Format("yyyy-MM-dd");
                    }
                },
                {title: "计划单价", index: 29, field: "PLAN_PRICE", width: 160, align: 'center'},
                {title: "请购单号", index: 30, field: "REQ_NO", width: 160, align: 'center'},
                {title: "签约日期", index: 31, field: "SIGN_DATE", width: 160, align: 'center',
                    formatter: function (value, row, index) {
                        if (value == undefined || value == '') {
                            return "";
                        }
                        var date = new Date(parseInt(value));
                        if (isNaN(date)) {
                            return ""
                        }
                        return date.Format("yyyy-MM-dd");
                    }
                },
                {title: "订单状态", index: 32, field: "STATUS_ID", width: 160, align: 'center'},
                {title: "ABC码", index: 33, field: "ABC_ID", width: 160, align: 'center'},
                {title: "库存分类(设备)", index: 34, field: "ITEM_GROPU4", width: 160, align: 'center'},
                {title: "采购订单数量", index: 35, field: "QTY_PUR", width: 160, align: 'center'},

            ]]
        };
        $div.Container(options);
    });
</script>